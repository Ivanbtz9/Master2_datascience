library(tseries)
library(forecast)

#Question 1

Rain = c(23.56, 26.07, 21.86, 31.24, 23.65, 23.88,
          26.41, 22.67, 31.69, 23.86, 24.11, 32.43,
          23.26, 22.57, 23.00, 27.88, 25.32, 25.08,
          27.76, 19.82, 24.78, 20.12, 24.34, 27.42,
          19.44, 21.63, 27.49, 19.43, 31.13, 23.09,
          25.85, 22.65, 22.75, 26.36, 17.70, 29.81,
          22.93, 19.22, 20.63, 35.34, 25.89, 18.65,
          23.06, 22.21, 22.18, 18.77, 28.21, 32.24,
          22.27, 27.57, 21.59, 16.93, 29.48, 31.60,
          26.25, 23.40, 25.42, 21.32, 25.02, 33.86,
          22.67, 18.82, 28.44, 26.16, 28.17, 34.08,
          33.82, 30.28, 27.92, 27.14, 24.40, 20.35,
          26.64, 27.01, 19.21, 27.74, 23.85, 21.23,
          28.15, 22.61, 19.80, 27.94, 21.47, 23.52,
          22.86, 17.69, 22.54, 23.28, 22.17, 20.84,
          38.10, 20.65, 22.97, 24.26, 23.01, 23.67,
          26.75, 25.36, 24.79, 27.88)

plot(Rain,col='black',type='l')

adf.test(Rain) #Rejet de la non stat
kpss.test(Rain) #Non Rejet de la stat

checkupRes(Rain) #Je pense que s'est un bruit blanc décentré, il n'y a rien a faire. 

L_Rain = log(Rain)

acf(L_Rain)
pacf(L_Rain)

model_auto_arima = auto.arima(L_Rain)

summary(model_auto_arima)

#Question 2

Volcano = c(200,150,100,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,50,50,0,0,0,0,0,0,0,0,0,0,0,0,0,100,500,350,200,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,200,150,100,50,0,0,0,200,150,100,50,40,30,20,10,400,300,210,110,10,20,50,50,50,40,30,20,10,200,150,100,50,0,0,0,0,0,0,0,100,75,50,25,0,0,120,90,60,30,0,40,30,120,85,150,400,275,175,75,0,60,45,30,15,100,75,50,25,0,0,0,0,0,0,340,255,170,85,130,100,65,30,0,0,0,0,200,150,100,50,0,0,0,0,280,210,140,70,0,0,0,0,0,0,0,0,0,140,285,205,105,45,0,0,0,0,0,0,0,300,225,150,75,0,80,60,40,20,0,120,90,60,30,100,75,50,55,15,15,15,15,15,160,130,90,50,0,0,0,0,0,0,0,0,0,0,60,45,30,15,0,0,0,0,200,150,160,255,150,95,40,80,110,77,45,13,0,0,0,0,0,0,0,0,50,37,25,13,0,0,0,180,135,90,45,400,300,200,160,45,30,15,0,0,0,0,0,120,130,90,50,130,90,60,30,0,0,0,0,0,0,0,0,80,180,170,170,695,490,375,195,30,15,0,200,150,100,70,80,65,50,75,50,200,130,80,40,525,450,375,300,225,150,75,0,0,0,100,205,140,90,30,0,0,0,0,0,0,140,105,70,35,0,160,120,80,40,0,0,0,160,120,80,40,0,0,0,120,90,60,30,0,0,0,0,400,300,240,170,50,170,125,85,45,20,15,10,5,0,0,30,25,15,5,180,135,90,45,0,60,45,30,15,0,60,45,30,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,120,80,40,0,0,0
)

plot(Volcano,type = 'l')

LV = log(Volcano+1)

plot(LV,type = 'l')

adf.test(LV)
kpss.test(LV)

checkupRes(LV)

#Avec un AR(5)
ARMA = Arima(LV, order = c(5, 0, 0), include.drift = FALSE)
summary(ARMA) 
plot(LV, type="l")
lines(as.numeric(fitted(ARMA)) , type="l", col="blue")

Res1 = LV - as.numeric(fitted(ARMA))
checkupRes(Res1)
#better to do like that 
checkupRes(ARMA$residuals)

# AUTO arima 
model_AA= auto.arima(LV,d=0)
plot(LV, type="l")
lines(as.numeric(fitted(model_AA)) , type="l", col="red")

Res2 = LV - as.numeric(fitted(model_AA))
checkupRes(Res2)

